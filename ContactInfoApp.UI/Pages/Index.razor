@page "/home"
@page "/home/{PhoneNumber}"
@using ContactInfoApp.Shared.Models

<div class="pb-2">
    <div class="row mb-2">
        <div class="col-auto">
            <div class="input-group">
                <RadzenTextBox Value=@_phoneNumber Placeholder="Введите номер телефона" @oninput="args => _phoneNumber = args.Value?.ToString()" @ref="_textBox" Style="min-width: 250px;" 
                               type="tel" />
                <div class="input-group-append">
                    <RadzenButton Click="async args => { _phoneNumber = null; await _textBox.Element.FocusAsync(); }" Icon="clear" ButtonStyle="ButtonStyle.Light" />
                </div>
            </div>
        </div>
    </div>
    <div class="row mb-2">
        <div class="col-auto">
            <RadzenButton Click="PasteClick" Text="Вставить" ButtonStyle="ButtonStyle.Secondary" />
            <RadzenButton Click="SearchClick" Text="Поиск" ButtonStyle="ButtonStyle.Primary" Disabled="string.IsNullOrEmpty(_phoneNumber) || !_phoneRegex.IsMatch(_phoneNumber)" />
        </div>
    </div>
</div>

@if (!_isLoading)
{
    if (_contact != null)
    {
        <div class="pb-2">
            <div class="icon-item mb-2">
                <span class="icon-item @(_contact.IsSpam ? "text-danger" : "")"><RadzenIcon Icon="contact_page" /></span>
                <span class="ml-1">@_contact.DisplayName</span>
            </div>
            @if (_tags != null && _tags.Any())
            {
                <RadzenDataList WrapItems="true" Data="@_tags">
                    <Template Context="tag">
                        <div class="icon-item">
                            <span class="icon-item @(_contact.IsSpam ? "text-danger" : "")"><RadzenIcon Icon="tag" /></span>
                            <span class="ml-1">@tag</span>
                        </div>
                    </Template>
                </RadzenDataList>
            }
        </div>
        @if (_contact.TagCount != null)
        {
            <div class="mb-2">
                Количество тегов: @_contact.TagCount
            </div>
        }
        @if (_comments != null && _comments.Any())
        {
            <div class="pb-2">
                <RadzenDataList Data="@_comments" TItem="CommentModel" class="rz-datalist-sm">
                    <Template Context="comment">
                        <div class="container-fluid pr-0" style="font-size: 0.9rem">
                            <div class="row">
                                <div class="col-auto p-0">
                                    <RadzenImage Path="@comment.AuthorImage" Class="rounded-circle" Style="width: 32px; height: 32px;" />
                                </div>
                                <div class="col">
                                    <div class="row">
                                        <div class="col pl-2">
                                            <div><span class="font-weight-bold small">@comment.Author</span></div>
                                            <div>@comment.Body</div>
                                        </div>
                                        <div class="col-auto">
                                            <span class="text-secondary small">@comment.Date.ToString("dd MMMM yyyy")</span>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col pl-2">
                                            <hr class=""/>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col d-flex justify-content-end">
                                            <div class="icon-item">
                                                <span class="icon-item"><RadzenIcon Icon="thumb_up"/></span>
                                                <span class="ml-1">@comment.Liked</span>
                                            </div>
                                            <div class="icon-item ml-2">
                                                <span class="icon-item"><RadzenIcon Icon="thumb_down"/></span>
                                                <span class="ml-1">@comment.Disliked</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </Template>
                </RadzenDataList>
            </div>
        }
        <div class="mb-2">
            <RadzenButton Click="CopyLinkClick" Text="Копировать ссылку" ButtonStyle="ButtonStyle.Info"></RadzenButton>
        </div>
    }
}
else
{
    <div class="spinner"></div>
}